```
CONFIDANT INSTRUCTION
```
Autor: Guodong Tang

student id: 1650373

E-mail: tgdeverbest@gmail.com


```
HOW-TO-RUN
```
1. 'git clone https://github.cs.adelaide.edu.au/a1650373/CONFIDANT.git' to directory 'X' or use patch file.
      
OR
 
    Download ns-3.22 srouce code, 
    
    run script apply_patches.sh to patch source tree.
 
2.  Eneter directory /X/CONFIDANT/untils/, run 'x_module_build.sh' to clean and rebuild source.

3.  Run the simulation via the script 'run_simulation.sh'. This script will also generate directories for traced files.

The actual command to run simulation in script 'run_simulation.sh' as follows:
```
./waf --run manet-routing-compare --command-template='%s --protocol=3 --pauseTime=5 --totalNodes=20 --sinks=7 --sizeX=1000 --sizeY=1000 --totalTime=400 --malicious=6'
```
Where you can add/change parameters as you like. 

The parameters are:

| Parameter     | Description 																		| Default Values |
|:-------------:|-------------------------------------------------|:--------------:|
| --protocol		|	Set 0=AODV; 1=CONFIDANT; 2=L-CONFIDANT; 3=TradeOff 		|0							 |
| --totalNodes	|	Number of total Nodes in the simulation					|30							 |
| --sinks				|	Number of sinks(destinations) to simulate. Notes: must less than the half of total number of nodes		 		|10							 |
| --malicious		|	Number of selfish nodes (randomly assigned) 	|3							 |
| --mvtSpeedMax		|	Max Movement Speed factor (in m/s) of every node		|20.0						 |
| --mvtSpeedMin		|	Min Movement Speed factor (in m/s) of every node		|5.0						 |
| --sizeX				|	Width of Simulation Environment									|1000.0					 |
| --sizeY				|	Height of Simulation Environment								|1000.0					 |
| --totalTime		|	Total Number of Seconds to run the Simulation		|1200.0						 |
| --power				|	Transmission Power Factor (in dBM) of each node |7.5						 |
| --startupMin	|	Startup Time Range minimum (seconds)						|50.0						 |
| --startupMax	|	Startup Time Range maximum (seconds)						|51.0						 |
| --pauseTime		|	Range from 0 to totalTime		|0.0						 |


```
HOW-TO-ANALYZE-TRACED-RESULTS
```
Eneter directory /X/CONFIDANT/untils/analysis.

1. run 'analysis_packet.sh' to analyze traced Pcap files and generate two csv files which record drop rate and overhead respectively.

   For the above two files, from top to down, these are values for 'aodv without selfish nodes', 'aodv', 'confidant', 'l-confidant', 'l-confidant-tradeoff'.

   Note: must place 'tshark.sh' in the same directory with 'analysis_packet.sh'.
   

2. Open MATLAB,

   run 'memory_analysis.m' to plot average storage usage of all nodes.

   run 'Power_analysis.m' to plot average remaining power of all nodes.
   
   run 'Detection_Time_analysis.m' to plot average selfish nodes detection time of all nodes.
   
   run 'DropRate_plot.m' to plot average drop rate of all nodes.
   
   run 'Overhead_plot.m' to plot average generated overhead of all nodes.
   

```
OTHER-FILES-INFO
 ```  
Files in directory '/X/CONFIDANT/untils/analysis/results' are example figures generated by MATLAB scripts under the parameters:

totalNodes == 20, malicious == 6, pauseTime == 5, sinks == 7 with different CONFIDANT protocols applied. 

Files in directory '/X/CONFIDANT/data' are traced Pcap files under the same parameters as above.

Directory '/X/CONFIDANT/ns-3.22' include all modified source code & config files based on the version 3.22!

'CONFIDANT_change.patch' is generated by git and can show differences between original ns-3.22 code and current modified CONFIDANT code.

```
TRACED-FILE-NAME-FORMAT
```
Generally, the format of names of trace files produced by simulation as follows:

```
 AODV_xxx_Txxx_Mxxx_PTxxx_Sxxx_[-x-0.pcap|x.csv]
```
AODV_xxx: 'xxx' indicates the name of CONFIDANT with different versions,

i.e.(CONFIDANT, L-CONFIDANT,L-CONFIDANT-TradeOff). when the 'xxx' is null, it means nodes are equipped with AODV only.

[T|M|PT|S]xxx: T->total number of nodes; M->number of selfish nodes; PT->pause time; S->number of sinks.

'xxx' indicates the actual values for these properties.

[-x-0.pcap]: 'x' means the id of the node in simulation.

[x.csv]; 'x' means the name of .csv files.







